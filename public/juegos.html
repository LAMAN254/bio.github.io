<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jorge - Juegos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #0f1016;
            color: white;
            overflow-x: hidden;
        }
        
        .navbar {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            background-color: #12141e;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .sidebar {
            width: 60px;
            height: 100vh;
            background-color: #12141e;
            position: fixed;
            left: 0;
            top: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 70px;
            z-index: 900;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .sidebar-icon {
            width: 40px;
            height: 40px;
            background-color: #1e2133;
            border-radius: 10px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c7293;
            font-size: 20px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        .sidebar-icon:hover {
            background-color: #2a2e43;
            transform: scale(1.1);
        }
        
        .main-content {
            margin-left: 60px;
            padding: 20px;
            padding-top: 80px;
        }
        
        .search-bar {
            width: 400px;
            background-color: #1e2133;
            border-radius: 20px;
            display: flex;
            align-items: center;
            padding: 8px 15px;
            margin-left: 20px;
            transition: background-color 0.3s;
        }
        
        .search-bar:hover {
            background-color: #2a2e43;
        }
        
        .search-bar input {
            background: transparent;
            border: none;
            width: 100%;
            color: white;
            outline: none;
            font-size: 14px;
        }
        
        .search-icon {
            color: #6c7293;
            margin-left: 10px;
        }
        
        .user-actions {
            display: flex;
            margin-left: auto;
            align-items: center;
        }
        
        .user-icon, .favorites-icon {
            width: 40px;
            height: 40px;
            background-color: #1e2133;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            transition: background-color 0.3s;
        }
        
        .user-icon:hover, .favorites-icon:hover {
            background-color: #2a2e43;
        }
        
        .login-button {
            background-color: #6c43ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            margin-left: 10px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        .login-button:hover {
            background-color: #5a36cc;
            transform: scale(1.05);
        }
        
        .welcome-section {
            display: flex;
            align-items: center;
            margin: 30px 0;
        }
        
        .welcome-icon {
            background-color: #6c43ff;
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .welcome-text {
            margin-left: 15px;
        }
        
        .welcome-text h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .welcome-text p {
            color: #6c7293;
            font-size: 14px;
        }
        
        .features {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .feature {
            display: flex;
            align-items: center;
            color: #fff;
            margin: 5px 0;
            padding: 5px;
            transition: transform 0.2s;
        }
        
        .feature:hover {
            transform: translateY(-3px);
        }
        
        .feature-icon {
            margin-right: 10px;
            background-color: #1e2133;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c43ff;
        }
        
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .game-card {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            height: 180px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(108, 67, 255, 0.3);
        }
        
        .game-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: filter 0.3s;
        }
        
        .game-card:hover img {
            filter: brightness(1.2);
        }
        
        .game-title {
            position: absolute;
            bottom: 15px;
            left: 15px;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        
        .game-tag {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .section-title {
            font-size: 18px;
            margin: 30px 0 15px 0;
            display: flex;
            align-items: center;
        }
        
        .see-more {
            color: #6c43ff;
            margin-left: 15px;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
        }
        
        .see-more:hover {
            color: #5a36cc;
        }
        
        .hot-tag { background-color: #ff4757; }
        .new-tag { background-color: #ff4757; }
        .updated-tag { background-color: #2ed573; }
        .top-rated-tag { background-color: #ffa502; }
        
        .main-game {
            grid-column: span 2;
            grid-row: span 2;
            height: 380px;
        }
        
        .game-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1001;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .game-container {
            background-color: #1e2133;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 15px;
            padding: 20px;
            position: relative;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(108, 67, 255, 0.5);
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff4757;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .close-btn:hover {
            background-color: #e03e4b;
        }
        
        .game-container h2 {
            margin-bottom: 10px;
        }
        
        .game-instructions {
            background-color: #2a2e43;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            font-size: 14px;
            color: #6c7293;
        }
        
        #tic-tac-toe-board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 5px;
            margin: 20px auto;
            width: fit-content;
        }
        
        .tic-cell {
            background-color: #2a2e43;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s;
        }
        
        .tic-cell:hover {
            background-color: #3a3e53;
        }
        
        #chess-board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            margin: 20px auto;
            width: fit-content;
            border: 2px solid #6c43ff;
        }
        
        .chess-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            cursor: pointer;
            user-select: none;
        }
        
        .white {
            background-color: #f0d9b5;
        }
        
        .black {
            background-color: #b58863;
        }
        
        .selected {
            background-color: #6c43ff !important;
        }
        
        #snake-game {
            width: 400px;
            height: 400px;
            border: 2px solid #6c43ff;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            background-color: #1e2133;
        }
        
        .snake-cell {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #6c43ff;
            border-radius: 2px;
        }
        
        .food {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #ff4757;
            border-radius: 50%;
        }
        
        #pong-canvas {
            background-color: #1e2133;
            display: block;
            margin: 20px auto;
            border: 2px solid #6c43ff;
        }
        
        #guess-number {
            text-align: center;
            margin: 20px auto;
            max-width: 400px;
        }
        
        #guess-input {
            padding: 8px;
            width: 100px;
            margin: 10px;
            text-align: center;
            background-color: #2a2e43;
            border: none;
            border-radius: 5px;
            color: white;
            font-size: 16px;
        }
        
        #guess-btn {
            background-color: #6c43ff;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #guess-btn:hover {
            background-color: #5a36cc;
        }
        
        #minesweeper-board {
            display: grid;
            grid-template-columns: repeat(17, 30px);
            grid-template-rows: repeat(10, 30px);
            gap: 2px;
            margin: 20px auto;
            background-color: #2a2e43;
            padding: 5px;
            border-radius: 5px;
            width: fit-content;
        }
        
        .mine-cell {
            background-color: #1e2133;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            cursor: pointer;
            user-select: none;
            border: 1px solid #6c43ff;
            transition: background-color 0.3s;
        }
        
        .mine-cell:hover {
            background-color: #2a2e43;
        }
        
        .revealed {
            background-color: #1e2133;
            color: #ffd700;
        }
        
        .mine {
            color: #ff4752;
        }
        
        #connect-four-board {
            display: grid;
            grid-template-columns: repeat(7, 50px);
            grid-template-rows: repeat(6, 50px);
            gap: 5px;
            margin: 20px auto;
            background-color: #2a2e43;
            padding: 10px;
            border-radius: 5px;
            width: fit-content;
        }
        
        .connect-cell {
            background-color: #1e2133;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .red-token {
            background-color: #ff4757;
            animation: drop 0.5s ease;
        }
        
        .yellow-token {
            background-color: #ffd700;
            animation: drop 0.5s ease;
        }
        
        @keyframes drop {
            from { transform: translateY(-100px); }
            to { transform: translateY(0); }
        }
        
        #memory-game {
            display: grid;
            grid-template-columns: repeat(4, 80px);
            grid-template-rows: repeat(4, 80px);
            gap: 10px;
            margin: 20px auto;
            width: fit-content;
        }
        
        .memory-card {
            background-color: #6c43ff;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.5s, background-color 0.3s;
        }
        
        .flipped {
            transform: rotateY(180deg);
            background-color: #fff;
            color: #000;
        }
        
        .matched {
            background-color: #2ed573;
            cursor: default;
        }
        
        #tetris-canvas {
            background-color: #1e2133;
            display: block;
            margin: 20px auto;
            border: 2px solid #6c43ff;
        }
        
        #pacman-canvas {
            background-color: #1e2133;
            display: block;
            margin: 20px auto;
            border: 2px solid #6c43ff;
        }
        
        #breakout-canvas {
            background-color: #1e2133;
            display: block;
            margin: 20px auto;
            border: 2px solid #6c43ff;
        }
        
        .game-btn {
            background-color: #6c43ff;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin: 10px 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        .game-btn:hover {
            background-color: #5a36cc;
            transform: scale(1.05);
        }
        
        .game-status {
            text-align: center;
            margin: 10px 0;
            font-size: 16px;
            color: #ffd700;
        }
        .move-table {
            margin-top: 20px;
            background-color: #2a2e43;
            border-radius: 5px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            width: fit-content;
        }
        
        .move-table h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .move-row {
            display: grid;
            grid-template-columns: 30px 80px 80px;
            gap: 10px;
            font-size: 14px;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .move-row span:first-child {
            color: #6c7293;
        }
        #chess-board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            margin: 20px auto;
            width: fit-content;
            border: 2px solid #6c43ff;
            background-color: #d0e7b9; /* Verde claro como en la imagen */
        }
        
        .chess-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s;
        }
        
        .white {
            background-color: #f0d9b5; /* Beige claro para casillas blancas */
        }
        
        .black {
            background-color: #769656; /* Marrón oscuro para casillas negras */
        }
        
        .selected {
            background-color: #6c43ff !important;
        }
        
        .chess-cell[data-piece^="♟"], .chess-cell[data-piece^="♜"], .chess-cell[data-piece^="♞"], 
        .chess-cell[data-piece^="♝"], .chess-cell[data-piece^="♛"], .chess-cell[data-piece^="♚"] {
            color: #4a2c2a; /* Marrón oscuro para piezas negras */
        }
        
        .chess-cell[data-piece^="♙"], .chess-cell[data-piece^="♖"], .chess-cell[data-piece^="♘"], 
        .chess-cell[data-piece^="♗"], .chess-cell[data-piece^="♕"], .chess-cell[data-piece^="♔"] {
            color: #d4a373; /* Beige claro para piezas blancas */
        }
        
        .move-table {
            margin-top: 20px;
            background-color: #2a2e43;
            border-radius: 5px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            width: fit-content;
        }
        
        .move-table h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .move-row {
            display: grid;
            grid-template-columns: 30px 80px 80px;
            gap: 10px;
            font-size: 14px;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .move-row span:first-child {
            color: #6c7293;
        }
        .difficulty-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2a2e43;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            text-align: center;
            color: #fff;
        }

        .difficulty-modal h3 {
            font-size: 24px;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .difficulty-modal p {
            font-size: 14px;
            margin-bottom: 20px;
            color: #6c7293;
        }

        .difficulty-btn {
            background-color: #6c43ff;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .difficulty-btn:hover {
            background-color: #4830b3;
        }
        #chess-board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            margin: 20px auto;
            width: fit-content;
            border: 2px solid #6c43ff;
            background-color: #d0e7b9;
        }
        
        .chess-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s;
        }
        
        .white {
            background-color: #f0d9b5;
        }
        
        .black {
            background-color: #769656;
        }
        
        .selected {
            background-color: #6c43ff !important;
        }
        
        .chess-cell[data-piece^="♟"], .chess-cell[data-piece^="♜"], .chess-cell[data-piece^="♞"], 
        .chess-cell[data-piece^="♝"], .chess-cell[data-piece^="♛"], .chess-cell[data-piece^="♚"] {
            color: #4a2c2a;
        }
        
        .chess-cell[data-piece^="♙"], .chess-cell[data-piece^="♖"], .chess-cell[data-piece^="♘"], 
        .chess-cell[data-piece^="♗"], .chess-cell[data-piece^="♕"], .chess-cell[data-piece^="♔"] {
            color: #d4a373;
        }
        
        .move-table {
            margin-top: 20px;
            background-color: #2a2e43;
            border-radius: 5px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            width: fit-content;
        }
        
        .move-table h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .move-row {
            display: grid;
            grid-template-columns: 30px 80px 80px;
            gap: 10px;
            font-size: 14px;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .move-row span:first-child {
            color: #6c7293;
        }
        
        .difficulty-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2a2e43;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            text-align: center;
            color: #fff;
        }

        .difficulty-modal h3 {
            font-size: 24px;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .difficulty-modal p {
            font-size: 14px;
            margin-bottom: 20px;
            color: #6c7293;
        }

        .difficulty-btn {
            background-color: #6c43ff;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .difficulty-btn:hover {
            background-color: #4830b3;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="menu-icon">≡</div>
        <div class="search-bar">
            <input type="text" placeholder="Buscar juegos...">
            <div class="search-icon">🔍</div>
        </div>
        <div class="user-actions">
            <div class="user-icon">👤</div>
            <div class="favorites-icon">❤️</div>
            <button class="login-button">Iniciar sesión</button>
        </div>
    </div>
    
    <div class="sidebar">
        <div class="sidebar-icon" title="Inicio">🏠</div>
        <div class="sidebar-icon" title="Buscar">🔍</div>
        <div class="sidebar-icon" title="Juegos">🎮</div>
        <div class="sidebar-icon" title="Populares">🔥</div>
        <div class="sidebar-icon" title="Actualizados">🔄</div>
        <div class="sidebar-icon" title="Amigos">👥</div>
        <div class="sidebar-icon" title="Logros">🏆</div>
        <div class="sidebar-icon" title="Salir">❌</div>
        <div class="sidebar-icon" title="Desafíos">🎯</div>
        <div class="sidebar-icon" title="Novedades">🌱</div>
    </div>
    
    <div class="main-content">
        <div class="welcome-section">
            <div class="welcome-icon">🎮</div>
            <div class="welcome-text">
                <h2>Juegos de Jorge</h2>
                <p>Disfruta de una colección de juegos clásicos y divertidos</p>
            </div>
        </div>
        
        <div class="features">
            <div class="feature">
                <div class="feature-icon">🎮</div>
                <span>11 juegos únicos</span>
            </div>
            <div class="feature">
                <div class="feature-icon">📲</div>
                <span>Juega en cualquier dispositivo</span>
            </div>
            <div class="feature">
                <div class="feature-icon">💻</div>
                <span>Interfaz moderna</span>
            </div>
            <div class="feature">
                <div class="feature-icon">👥</div>
                <span>Compite contra la IA</span>
            </div>
            <div class="feature">
                <div class="feature-icon">🎁</div>
                <span>Diversión garantizada</span>
            </div>
        </div>
        
        <div class="games-grid">
            <div class="game-card main-game" onclick="openGame('snake')">
                <img src="imagenes/snake.jpeg" alt="Snake">
                <div class="game-title">Snake</div>
            </div>
            <div class="game-card" onclick="openGame('chess')">
                <img src="imagenes/ajedrez.jpg" alt="Ajedrez">
                <div class="game-tag top-rated-tag">TOP RATED</div>
                <div class="game-title">Ajedrez</div>
            </div>
            <div class="game-card" onclick="openGame('tic-tac-toe')">
                <img src="imagenes/3-raya.jpg" alt="Tres en Raya">
                <div class="game-title">Tres en Raya</div>
            </div>
            <div class="game-card" onclick="openGame('memory')">
                <img src="imagenes/memoria.png" alt="Memoria">
                <div class="game-title">Memoria</div>
            </div>
            <div class="game-card" onclick="openGame('pong')">
                <img src="imagenes/pong.png" alt="Pong">
                <div class="game-title">Pong</div>
            </div>
        </div>
        
        <h3 class="section-title">Juegos destacados</h3>
        
        <div class="games-grid">
            <div class="game-card" onclick="openGame('guess-number')">
                <img src="imagenes/numero.jpg" alt="Adivina el Número">
                <div class="game-tag new-tag">NEW</div>
                <div class="game-title">Adivina</div>
            </div>
            <div class="game-card" onclick="openGame('minesweeper')">
                <img src="imagenes/minas.png" alt="Buscaminas">
                <div class="game-tag hot-tag">HOT</div>
                <div class="game-title">Buscaminas</div>
            </div>
            <div class="game-card" onclick="openGame('connect-four')">
                <img src="imagenes/4.png" alt="Cuatro en Línea">
                <div class="game-tag hot-tag">HOT</div>
                <div class="game-title">Cuatro en Línea</div>
            </div>
            <div class="game-card" onclick="openGame('tetris')">
                <img src="imagenes/Tetris.png" alt="Tetris">
                <div class="game-tag updated-tag">UPDATED</div>
                <div class="game-title">Tetris</div>
            </div>
            <div class="game-card" onclick="openGame('pacman')">
                <img src="imagenes/pacman_PNG2.png" alt="Pacman">
                <div class="game-tag hot-tag">HOT</div>
                <div class="game-title">Pacman</div>
            </div>
            <div class="game-card" onclick="openGame('breakout')">
                <img src="imagenes/atari-breakout-icon.png" alt="Breakout">
                <div class="game-tag updated-tag">UPDATED</div>
                <div class="game-title">Breakout</div>
            </div>
        </div>
        
        <h3 class="section-title">Juegos nuevos <a href="#" class="see-more">Ver más</a></h3>
    </div>
    
    <div id="game-modal" class="game-modal">
        <div class="game-container">
            <button class="close-btn" onclick="closeGame()">×</button>
            <h2 id="game-title">Juego</h2>
            <div id="game-instructions" class="game-instructions"></div>
            <div id="game-content"></div>
            <div id="game-controls"></div>
        </div>
    </div>
    
    <script>
        let activeGame = null;

        function openGame(gameId) {
            const modal = document.getElementById('game-modal');
            const gameTitle = document.getElementById('game-title');
            const gameInstructions = document.getElementById('game-instructions');
            const gameContent = document.getElementById('game-content');
            const gameControls = document.getElementById('game-controls');
            
            closeGame(); // Cerrar cualquier juego activo antes de abrir uno nuevo
            activeGame = gameId;
            modal.style.display = 'flex';
            gameTitle.textContent = games[gameId].title || 'Juego';
            gameInstructions.innerHTML = games[gameId].instructions || '';
            gameContent.innerHTML = '';
            gameControls.innerHTML = '';
            
            if (games[gameId].setup) {
                games[gameId].setup();
            }
        }

        function closeGame() {
            const modal = document.getElementById('game-modal');
            modal.style.display = 'none';
            if (activeGame && games[activeGame]) {
                const game = games[activeGame];
                if (game.gameInterval) clearInterval(game.gameInterval);
                if (game.gameLoop) cancelAnimationFrame(game.gameLoop);
                if (game.keydownHandler) window.removeEventListener('keydown', game.keydownHandler);
                if (game.keyupHandler) window.removeEventListener('keyup', game.keyupHandler);
                if (game.reset) game.reset();
            }
            activeGame = null;
        }

        const games = {
            'tic-tac-toe': {
                title: 'Tres en Raya',
                instructions: 'Haz clic en una celda para colocar tu símbolo (X). El bot juega con O. Gana alinear 3 símbolos. Usa flechas/WASD para mover el cursor y Enter para jugar.',
                setup: function() {
                    let html = '<div id="tic-tac-toe-board">';
                    for (let i = 0; i < 9; i++) {
                        html += `<div class="tic-cell" data-index="${i}"></div>`;
                    }
                    html += '</div>';
                    html += '<div id="tic-status" class="game-status">Turno de X</div>';
                    html += '<button class="game-btn" onclick="games[\'tic-tac-toe\'].reset()">Reiniciar</button>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                    const cells = document.querySelectorAll('.tic-cell');
                    cells.forEach(cell => cell.addEventListener('click', () => this.makeMove(cell)));
                    this.currentIndex = 4; // Centro por defecto
                    this.keydownHandler = (e) => {
                        if (e.key === 'ArrowUp' || e.key === 'w') {
                            if (this.currentIndex > 2) this.currentIndex -= 3;
                        } else if (e.key === 'ArrowDown' || e.key === 's') {
                            if (this.currentIndex < 6) this.currentIndex += 3;
                        } else if (e.key === 'ArrowLeft' || e.key === 'a') {
                            if (this.currentIndex % 3 > 0) this.currentIndex--;
                        } else if (e.key === 'ArrowRight' || e.key === 'd') {
                            if (this.currentIndex % 3 < 2) this.currentIndex++;
                        } else if (e.key === 'Enter' && !this.gameOver) {
                            this.makeMove(cells[this.currentIndex]);
                        }
                        cells.forEach(c => c.style.border = '');
                        cells[this.currentIndex].style.border = '2px solid #6c43ff';
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                },
                reset: function() {
                    this.board = Array(9).fill('');
                    this.currentPlayer = 'X';
                    this.gameOver = false;
                    this.currentIndex = 4;
                    const cells = document.querySelectorAll('.tic-cell');
                    cells.forEach(cell => cell.textContent = '');
                    document.getElementById('tic-status').textContent = 'Turno de X';
                    cells.forEach(c => c.style.border = '');
                    cells[this.currentIndex].style.border = '2px solid #6c43ff';
                    if (this.currentPlayer === 'O') this.botTurn();
                },
                makeMove: function(cell) {
                    const index = parseInt(cell.getAttribute('data-index'));
                    if (this.board[index] === '' && !this.gameOver) {
                        this.board[index] = this.currentPlayer;
                        cell.textContent = this.currentPlayer;
                        console.log(`Sonido: ${this.currentPlayer} colocado en ${index}`);
                        if (this.checkWin()) {
                            document.getElementById('tic-status').textContent = `¡${this.currentPlayer} ha ganado!`;
                            this.gameOver = true;
                            console.log('Sonido: Ganador');
                        } else if (!this.board.includes('')) {
                            document.getElementById('tic-status').textContent = '¡Empate!';
                            this.gameOver = true;
                            console.log('Sonido: Empate');
                        } else {
                            this.currentPlayer = this.currentPlayer === 'X' ? 'O' : 'X';
                            document.getElementById('tic-status').textContent = `Turno de ${this.currentPlayer}`;
                            if (this.currentPlayer === 'O') this.botTurn();
                        }
                    }
                },
                checkWin: function() {
                    const winPatterns = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
                    return winPatterns.some(pattern => pattern.every(i => this.board[i] === this.currentPlayer));
                },
                botTurn: function() {
                    if (this.gameOver || this.currentPlayer !== 'O') return;
                    const emptyCells = this.board.map((val, idx) => val === '' ? idx : null).filter(idx => idx !== null);
                    let move = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                    const winPatterns = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
                    for (let pattern of winPatterns) {
                        const oCount = pattern.filter(i => this.board[i] === 'O').length;
                        const xCount = pattern.filter(i => this.board[i] === 'X').length;
                        if (oCount === 2 && xCount === 0) {
                            move = pattern.find(i => this.board[i] === '');
                            break;
                        } else if (xCount === 2 && oCount === 0) {
                            move = pattern.find(i => this.board[i] === '');
                            break;
                        }
                    }
                    setTimeout(() => {
                        this.makeMove(document.querySelector(`.tic-cell[data-index="${move}"]`));
                    }, 500);
                }
            },
            'chess': {
                title: 'Ajedrez',
                instructions: 'Haz clic en una pieza para seleccionarla y luego en una casilla para moverla. Usa flechas/WASD para mover la selección. Las blancas juegan primero. Presiona P para pausar.',
                setup: function() {
                    let html = '<div id="chess-board">';
                    for (let i = 0; i < 8; i++) {
                        for (let j = 0; j < 8; j++) {
                            const color = (i + j) % 2 === 0 ? 'white' : 'black';
                            html += `<div class="chess-cell ${color}" data-row="${i}" data-col="${j}"></div>`;
                        }
                    }
                    html += '</div>';
                    html += '<div id="chess-status" class="game-status">Turno de las blancas</div>';
                    html += '<div id="chess-moves" class="move-table"><h3>Movimientos</h3><div id="chess-moves-list"></div></div>';
                    html += '<div id="chess-controls">';
                    html += '<button class="game-btn" onclick="games[\'chess\'].togglePause()">Pausar</button>';
                    html += '<button class="game-btn" onclick="games[\'chess\'].reset()">Reiniciar</button>';
                    html += '</div>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                    const cells = document.querySelectorAll('.chess-cell');
                    cells.forEach(cell => cell.addEventListener('click', (e) => {
                        if (this.paused) return;
                        const row = parseInt(e.target.getAttribute('data-row'));
                        const col = parseInt(e.target.getAttribute('data-col'));
                        this.handleCellClick(row, col);
                    }));
                    this.keydownHandler = (e) => {
                        if (this.paused) return;
                        if (!this.selectedPiece) return;
                        const { row, col } = this.selectedPiece;
                        if (e.key === 'ArrowUp' || e.key === 'w') {
                            if (row > 0) this.handleCellClick(row - 1, col);
                        } else if (e.key === 'ArrowDown' || e.key === 's') {
                            if (row < 7) this.handleCellClick(row + 1, col);
                        } else if (e.key === 'ArrowLeft' || e.key === 'a') {
                            if (col > 0) this.handleCellClick(row, col - 1);
                        } else if (e.key === 'ArrowRight' || e.key === 'd') {
                            if (col < 7) this.handleCellClick(row, col + 1);
                        } else if (e.key === 'p') {
                            this.togglePause();
                        }
                        cells.forEach(c => c.classList.remove('selected'));
                        if (this.selectedPiece) {
                            document.querySelector(`.chess-cell[data-row="${this.selectedPiece.row}"][data-col="${this.selectedPiece.col}"]`).classList.add('selected');
                        }
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                },
                reset: function() {
                    this.selectedPiece = null;
                    this.board = Array(8).fill().map(() => Array(8).fill(''));
                    for (let i = 0; i < 8; i++) {
                        this.board[1][i] = '♟';
                        this.board[6][i] = '♙';
                    }
                    this.board[0] = ['♜', '♞', '♝', '♛', '♚', '♝', '♞', '♜'];
                    this.board[7] = ['♖', '♘', '♗', '♕', '♔', '♗', '♘', '♖'];
                    this.currentPlayer = 'white';
                    this.gameOver = false;
                    this.paused = false;
                    this.moves = [];
                    this.renderBoard();
                    document.getElementById('chess-status').textContent = 'Turno de las blancas';
                    document.getElementById('chess-moves-list').innerHTML = '';
                    document.querySelector('#chess-controls button:first-child').textContent = 'Pausar';
                    if (this.currentPlayer === 'black') setTimeout(() => this.botTurn(), 500);
                },
                togglePause: function() {
                    if (this.gameOver) return;
                    this.paused = !this.paused;
                    document.querySelector('#chess-controls button:first-child').textContent = this.paused ? 'Reanudar' : 'Pausar';
                    console.log(`Sonido: ${this.paused ? 'Pausa' : 'Reanudar'}`);
                    if (!this.paused && this.currentPlayer === 'black') setTimeout(() => this.botTurn(), 500);
                },
                renderBoard: function() {
                    for (let i = 0; i < 8; i++) {
                        for (let j = 0; j < 8; j++) {
                            const cell = document.querySelector(`.chess-cell[data-row="${i}"][data-col="${j}"]`);
                            cell.textContent = this.board[i][j];
                            cell.className = `chess-cell ${(i + j) % 2 === 0 ? 'white' : 'black'}`;
                            if (this.board[i][j]) {
                                cell.setAttribute('data-piece', this.board[i][j]);
                            } else {
                                cell.removeAttribute('data-piece');
                            }
                        }
                    }
                },
                handleCellClick: function(row, col) {
                    if (this.gameOver || this.paused) return;
                    if (!this.selectedPiece) {
                        const piece = this.board[row][col];
                        if (piece && this.isPieceColor(piece, this.currentPlayer)) {
                            this.selectedPiece = { row, col };
                            document.querySelector(`.chess-cell[data-row="${row}"][data-col="${col}"]`).classList.add('selected');
                            console.log(`Sonido: Pieza seleccionada - ${piece}`);
                        }
                    } else {
                        const { row: fromRow, col: fromCol } = this.selectedPiece;
                        if (this.isValidMove(fromRow, fromCol, row, col)) {
                            const moveNotation = this.getMoveNotation(fromRow, fromCol, row, col);
                            this.board[row][col] = this.board[fromRow][fromCol];
                            this.board[fromRow][fromCol] = '';
                            console.log(`Sonido: Movimiento - de (${fromRow},${fromCol}) a (${row},${col})`);
                            this.moves.push({ player: this.currentPlayer, move: moveNotation });
                            this.renderMoves();
                            this.currentPlayer = this.currentPlayer === 'white' ? 'black' : 'white';
                            document.getElementById('chess-status').textContent = `Turno de las ${this.currentPlayer}s`;
                            if (!this.isKingAlive(this.currentPlayer === 'white' ? 'black' : 'white')) {
                                this.gameOver = true;
                                document.getElementById('chess-status').textContent = `¡${this.currentPlayer === 'white' ? 'Blancas' : 'Negras'} ganan! El rey ha sido capturado.`;
                                console.log('Sonido: Victoria - Rey capturado');
                                return;
                            }
                            if (this.checkForCheck(this.currentPlayer)) {
                                document.getElementById('chess-status').textContent = `¡Jaque al rey ${this.currentPlayer}!`;
                                console.log('Sonido: Jaque');
                                if (this.checkForCheckmate(this.currentPlayer)) {
                                    this.gameOver = true;
                                    document.getElementById('chess-status').textContent = `¡Jaque mate! ${this.currentPlayer === 'white' ? 'Negras' : 'Blancas'} ganan.`;
                                    console.log('Sonido: Jaque mate');
                                    return;
                                }
                            }
                            this.selectedPiece = null;
                            this.renderBoard();
                            if (this.currentPlayer === 'black') {
                                setTimeout(() => this.botTurn(), 500);
                            }
                        } else {
                            this.selectedPiece = null;
                            this.renderBoard();
                        }
                    }
                },
                getMoveNotation: function(fromRow, fromCol, toRow, toCol) {
                    const files = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'];
                    const piece = this.board[fromRow][fromCol];
                    let pieceSymbol = '';
                    switch (piece) {
                        case '♙': case '♟': break;
                        case '♖': case '♜': pieceSymbol = 'R'; break;
                        case '♘': case '♞': pieceSymbol = 'N'; break;
                        case '♗': case '♝': pieceSymbol = 'B'; break;
                        case '♕': case '♛': pieceSymbol = 'Q'; break;
                        case '♔': case '♚': pieceSymbol = 'K'; break;
                    }
                    const from = `${files[fromCol]}${8 - fromRow}`;
                    const to = `${files[toCol]}${8 - toRow}`;
                    return `${pieceSymbol}${from}${this.board[toRow][toCol] ? 'x' : '-'}${to}`;
                },
                renderMoves: function() {
                    const movesList = document.getElementById('chess-moves-list');
                    movesList.innerHTML = '';
                    for (let i = 0; i < this.moves.length; i += 2) {
                        const moveNumber = Math.floor(i / 2) + 1;
                        const whiteMove = this.moves[i].move;
                        const blackMove = i + 1 < this.moves.length ? this.moves[i + 1].move : '';
                        movesList.innerHTML += `<div class="move-row"><span>${moveNumber}.</span><span>${whiteMove}</span><span>${blackMove}</span></div>`;
                    }
                    movesList.scrollTop = movesList.scrollHeight;
                },
                isPieceColor: function(piece, color) {
                    const whitePieces = ['♙', '♖', '♘', '♗', '♕', '♔'];
                    const blackPieces = ['♟', '♜', '♞', '♝', '♛', '♚'];
                    return color === 'white' ? whitePieces.includes(piece) : blackPieces.includes(piece);
                },
                isValidMove: function(fromRow, fromCol, toRow, toCol) {
                    const piece = this.board[fromRow][fromCol];
                    const targetPiece = this.board[toRow][toCol];
                    if (targetPiece && this.isPieceColor(targetPiece, this.currentPlayer)) return false;

                    const dx = toRow - fromRow;
                    const dy = toCol - fromCol;

                    switch (piece) {
                        case '♙':
                            if (this.currentPlayer === 'white') {
                                if (fromRow === 6 && dx === -2 && dy === 0 && this.board[fromRow - 1][fromCol] === '' && this.board[toRow][toCol] === '') return true;
                                if (dx === -1 && dy === 0 && !targetPiece) return true;
                                if (dx === -1 && Math.abs(dy) === 1 && targetPiece && !this.isPieceColor(targetPiece, 'white')) return true;
                                return false;
                            }
                            break;
                        case '♟':
                            if (this.currentPlayer === 'black') {
                                if (fromRow === 1 && dx === 2 && dy === 0 && this.board[fromRow + 1][fromCol] === '' && this.board[toRow][toCol] === '') return true;
                                if (dx === 1 && dy === 0 && !targetPiece) return true;
                                if (dx === 1 && Math.abs(dy) === 1 && targetPiece && !this.isPieceColor(targetPiece, 'black')) return true;
                                return false;
                            }
                            break;
                        case '♖': case '♜':
                            if (dx === 0 || dy === 0) {
                                const stepX = dx === 0 ? 0 : dx / Math.abs(dx);
                                const stepY = dy === 0 ? 0 : dy / Math.abs(dy);
                                let r = fromRow + stepX;
                                let c = fromCol + stepY;
                                while (r !== toRow || c !== toCol) {
                                    if (this.board[r][c]) return false;
                                    r += stepX;
                                    c += stepY;
                                }
                                return true;
                            }
                            break;
                        case '♘': case '♞':
                            if ((Math.abs(dx) === 2 && Math.abs(dy) === 1) || (Math.abs(dx) === 1 && Math.abs(dy) === 2)) return true;
                            break;
                        case '♗': case '♝':
                            if (Math.abs(dx) === Math.abs(dy)) {
                                const stepX = dx / Math.abs(dx);
                                const stepY = dy / Math.abs(dy);
                                let r = fromRow + stepX;
                                let c = fromCol + stepY;
                                while (r !== toRow || c !== toCol) {
                                    if (this.board[r][c]) return false;
                                    r += stepX;
                                    c += stepY;
                                }
                                return true;
                            }
                            break;
                        case '♕': case '♛':
                            if (dx === 0 || dy === 0 || Math.abs(dx) === Math.abs(dy)) {
                                const stepX = dx === 0 ? 0 : dx / Math.abs(dx);
                                const stepY = dy === 0 ? 0 : dy / Math.abs(dy);
                                let r = fromRow + stepX;
                                let c = fromCol + stepY;
                                while (r !== toRow || c !== toCol) {
                                    if (this.board[r][c]) return false;
                                    r += stepX;
                                    c += stepY;
                                }
                                return true;
                            }
                            break;
                        case '♔': case '♚':
                            if (Math.abs(dx) <= 1 && Math.abs(dy) <= 1) return true;
                            break;
                    }
                    return false;
                },
                isKingAlive: function(color) {
                    const king = color === 'white' ? '♔' : '♚';
                    for (let i = 0; i < 8; i++) {
                        for (let j = 0; j < 8; j++) {
                            if (this.board[i][j] === king) return true;
                        }
                    }
                    return false;
                },
                checkForCheck: function(color) {
                    let kingRow, kingCol;
                    const king = color === 'white' ? '♔' : '♚';
                    for (let i = 0; i < 8; i++) {
                        for (let j = 0; j < 8; j++) {
                            if (this.board[i][j] === king) {
                                kingRow = i;
                                kingCol = j;
                                break;
                            }
                        }
                    }
                    for (let i = 0; i < 8; i++) {
                        for (let j = 0; j < 8; j++) {
                            if (this.board[i][j] && !this.isPieceColor(this.board[i][j], color)) {
                                if (this.isValidMove(i, j, kingRow, kingCol)) {
                                    return true;
                                }
                            }
                        }
                    }
                    return false;
                },
                checkForCheckmate: function(color) {
                    if (!this.checkForCheck(color)) return false;
                    let kingRow, kingCol;
                    const king = color === 'white' ? '♔' : '♚';
                    for (let i = 0; i < 8; i++) {
                        for (let j = 0; j < 8; j++) {
                            if (this.board[i][j] === king) {
                                kingRow = i;
                                kingCol = j;
                                break;
                            }
                        }
                    }
                    for (let di = -1; di <= 1; di++) {
                        for (let dj = -1; dj <= 1; dj++) {
                            const newRow = kingRow + di;
                            const newCol = kingCol + dj;
                            if (newRow >= 0 && newRow < 8 && newCol >= 0 && newCol < 8) {
                                if (this.isValidMove(kingRow, kingCol, newRow, newCol)) {
                                    const tempPiece = this.board[newRow][newCol];
                                    this.board[newRow][newCol] = this.board[kingRow][kingCol];
                                    this.board[kingRow][kingCol] = '';
                                    const stillInCheck = this.checkForCheck(color);
                                    this.board[kingRow][kingCol] = this.board[newRow][newCol];
                                    this.board[newRow][newCol] = tempPiece;
                                    if (!stillInCheck) return false;
                                }
                            }
                        }
                    }
                    return true;
                },
                botTurn: function() {
                    if (this.gameOver || this.paused || this.currentPlayer !== 'black') return;
                    console.log('Bot Turn started');
                    const maxTime = 500; // Límite de 500ms para respuesta razonable
                    const startTime = performance.now();

                    const moves = this.getAllPossibleMoves('black');
                    console.log('Possible moves:', moves.length);

                    if (moves.length === 0) {
                        if (this.checkForCheckmate('black')) {
                            this.gameOver = true;
                            document.getElementById('chess-status').textContent = '¡Jaque mate! Blancas ganan.';
                            console.log('Sonido: Jaque mate');
                        } else {
                            this.gameOver = true;
                            document.getElementById('chess-status').textContent = '¡Empate! No hay movimientos válidos.';
                            console.log('Sonido: Empate');
                        }
                        return;
                    }

                    let bestMove = null;
                    let bestScore = -Infinity;

                    for (const move of moves) {
                        const { fromRow, fromCol, toRow, toCol } = move;
                        const tempPiece = this.board[toRow][toCol];
                        this.board[toRow][toCol] = this.board[fromRow][fromCol];
                        this.board[fromRow][fromCol] = '';
                        const score = this.evaluateMove(fromRow, fromCol, toRow, toCol);
                        this.board[fromRow][fromCol] = this.board[toRow][toCol];
                        this.board[toRow][toCol] = tempPiece;
                        console.log(`Evaluated move ${fromRow},${fromCol} to ${toRow},${toCol} with score: ${score}`);

                        if (score > bestScore) {
                            bestScore = score;
                            bestMove = move;
                        }

                        if (performance.now() - startTime > maxTime) {
                            console.log('Time limit reached, selecting best move so far');
                            break;
                        }
                    }

                    if (bestMove) {
                        this.selectedPiece = { row: bestMove.fromRow, col: bestMove.fromCol };
                        this.handleCellClick(bestMove.toRow, bestMove.toCol);
                        console.log('Bot move executed:', bestMove);
                    } else {
                        // Fallback a movimiento aleatorio si no se encontró uno mejor
                        bestMove = moves[Math.floor(Math.random() * moves.length)];
                        this.selectedPiece = { row: bestMove.fromRow, col: bestMove.fromCol };
                        this.handleCellClick(bestMove.toRow, bestMove.toCol);
                        console.log('Fallback to random move:', bestMove);
                    }
                },
                getAllPossibleMoves: function(color) {
                    const moves = [];
                    for (let i = 0; i < 8; i++) {
                        for (let j = 0; j < 8; j++) {
                            if (this.board[i][j] && this.isPieceColor(this.board[i][j], color)) {
                                for (let r = 0; r < 8; r++) {
                                    for (let c = 0; c < 8; c++) {
                                        if (this.isValidMove(i, j, r, c)) {
                                            moves.push({ fromRow: i, fromCol: j, toRow: r, toCol: c });
                                        }
                                    }
                                }
                            }
                        }
                    }
                    return moves;
                },
                evaluateMove: function(fromRow, fromCol, toRow, toCol) {
                    const pieceValues = {
                        '♙': 100, '♟': -100,
                        '♘': 320, '♞': -320,
                        '♗': 330, '♝': -330,
                        '♖': 500, '♜': -500,
                        '♕': 900, '♛': -900,
                        '♔': 20000, '♚': -20000
                    };

                    let score = 0;
                    const capturedPiece = this.board[toRow][toCol];
                    if (capturedPiece) {
                        score += pieceValues[capturedPiece] || 0; // Ganancia por capturar
                    }

                    // Bonificación por movilidad (simplificada)
                    const originalMoves = this.getAllPossibleMoves('black').length;
                    this.board[toRow][toCol] = this.board[fromRow][fromCol];
                    this.board[fromRow][fromCol] = '';
                    const newMoves = this.getAllPossibleMoves('black').length;
                    this.board[fromRow][fromCol] = this.board[toRow][toCol];
                    this.board[toRow][toCol] = capturedPiece;
                    score += (newMoves - originalMoves) * 0.5;

                    // Penalización si el rey queda en jaque
                    const originalKingSafe = !this.checkForCheck('black');
                    this.board[toRow][toCol] = this.board[fromRow][fromCol];
                    this.board[fromRow][fromCol] = '';
                    const newKingSafe = !this.checkForCheck('black');
                    this.board[fromRow][fromCol] = this.board[toRow][toCol];
                    this.board[toRow][toCol] = capturedPiece;
                    if (!newKingSafe && originalKingSafe) score -= 1000;

                    return score;
                }
            },
            'snake': {
                title: 'Snake',
                instructions: 'Usa las flechas o WASD para mover la serpiente. Come la comida (roja) para crecer. Evita chocar con las paredes o contigo mismo. Presiona P para pausar.',
                setup: function() {
                    let html = '<div id="snake-game"></div>';
                    html += '<div id="snake-score" class="game-status">Puntuación: 0</div>';
                    html += '<div id="snake-controls">';
                    html += '<button class="game-btn" id="snake-start">Iniciar</button>';
                    html += '<button class="game-btn" id="snake-pause" style="display:none;">Pausar</button>';
                    html += '</div>';
                    document.getElementById('game-content').innerHTML = html;
                    document.getElementById('snake-start').addEventListener('click', () => {
                        this.startGame();
                        document.getElementById('snake-start').style.display = 'none';
                        document.getElementById('snake-pause').style.display = 'inline-block';
                    });
                    document.getElementById('snake-pause').addEventListener('click', () => {
                        this.togglePause();
                    });
                    this.keydownHandler = (e) => {
                        e.preventDefault();
                        if (e.key === 'ArrowUp' || e.key === 'w') this.nextDirection = 'up';
                        if (e.key === 'ArrowDown' || e.key === 's') this.nextDirection = 'down';
                        if (e.key === 'ArrowLeft' || e.key === 'a') this.nextDirection = 'left';
                        if (e.key === 'ArrowRight' || e.key === 'd') this.nextDirection = 'right';
                        if (e.key === 'p') this.togglePause();
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                },
                reset: function() {
                    if (this.gameInterval) clearInterval(this.gameInterval);
                    this.snake = [];
                    this.food = null;
                    this.score = 0;
                    this.gameOver = true;
                    this.paused = false;
                    document.getElementById('snake-score').textContent = 'Puntuación: 0';
                    document.getElementById('snake-game').innerHTML = '';
                    document.getElementById('snake-start').style.display = 'inline-block';
                    document.getElementById('snake-pause').style.display = 'none';
                },
                startGame: function() {
                    this.boardSize = 40;
                    this.cellSize = 10;
                    this.snake = [{ x: 20, y: 20 }];
                    this.direction = 'right';
                    this.nextDirection = 'right';
                    this.food = this.generateFood();
                    this.score = 0;
                    this.gameOver = false;
                    this.paused = false;
                    document.getElementById('snake-pause').textContent = 'Pausar';
                    this.render();
                    this.gameInterval = setInterval(() => this.gameLoop(), 100);
                    console.log('Sonido: Juego iniciado');
                },
                togglePause: function() {
                    if (this.gameOver) return;
                    this.paused = !this.paused;
                    document.getElementById('snake-pause').textContent = this.paused ? 'Reanudar' : 'Pausar';
                    console.log(`Sonido: ${this.paused ? 'Pausa' : 'Reanudar'}`);
                },
                gameLoop: function() {
                    if (this.gameOver || this.paused) return;
                    if (this.snake.length < 2 || (
                        (this.nextDirection === 'up' && this.direction !== 'down') ||
                        (this.nextDirection === 'down' && this.direction !== 'up') ||
                        (this.nextDirection === 'left' && this.direction !== 'right') ||
                        (this.nextDirection === 'right' && this.direction !== 'left')
                    )) {
                        this.direction = this.nextDirection;
                    }
                    const head = { ...this.snake[0] };
                    switch (this.direction) {
                        case 'up': head.y--; break;
                        case 'down': head.y++; break;
                        case 'left': head.x--; break;
                        case 'right': head.x++; break;
                    }
                    if (head.x < 0 || head.x >= this.boardSize || head.y < 0 || head.y >= this.boardSize || this.snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                        this.gameOver = true;
                        clearInterval(this.gameInterval);
                        document.getElementById('snake-score').textContent = `Game Over! Puntuación: ${this.score}`;
                        document.getElementById('snake-start').style.display = 'inline-block';
                        document.getElementById('snake-pause').style.display = 'none';
                        console.log('Sonido: Game Over');
                        return;
                    }
                    this.snake.unshift(head);
                    if (head.x === this.food.x && head.y === this.food.y) {
                        this.score += 10;
                        this.food = this.generateFood();
                        console.log('Sonido: Comida comida');
                    } else {
                        this.snake.pop();
                    }
                    this.render();
                    document.getElementById('snake-score').textContent = `Puntuación: ${this.score}`;
                },
                generateFood: function() {
                    let x, y;
                    do {
                        x = Math.floor(Math.random() * this.boardSize);
                        y = Math.floor(Math.random() * this.boardSize);
                    } while (this.snake.some(segment => segment.x === x && segment.y === y));
                    return { x, y };
                },
                render: function() {
                    const gameBoard = document.getElementById('snake-game');
                    gameBoard.innerHTML = '';
                    this.snake.forEach(segment => {
                        const cell = document.createElement('div');
                        cell.className = 'snake-cell';
                        cell.style.left = `${segment.x * this.cellSize}px`;
                        cell.style.top = `${segment.y * this.cellSize}px`;
                        gameBoard.appendChild(cell);
                    });
                    const food = document.createElement('div');
                    food.className = 'food';
                    food.style.left = `${this.food.x * this.cellSize}px`;
                    food.style.top = `${this.food.y * this.cellSize}px`;
                    gameBoard.appendChild(food);
                }
            },
            'pong': {
                title: 'Pong',
                instructions: 'Usa flechas arriba/abajo o W/S para mover la paleta izquierda. El bot controla la derecha. Marca 10 puntos para ganar.',
                setup: function() {
                    let html = '<canvas id="pong-canvas" width="600" height="400"></canvas>';
                    html += '<div id="pong-score" class="game-status">Jugador: 0 - Bot: 0</div>';
                    html += '<button class="game-btn" onclick="games[\'pong\'].reset()">Reiniciar</button>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                },
                reset: function() {
                    if (this.gameLoop) cancelAnimationFrame(this.gameLoop);
                    const canvas = document.getElementById('pong-canvas');
                    const ctx = canvas.getContext('2d');
                    this.paddleWidth = 10;
                    this.paddleHeight = 80;
                    this.ballSize = 10;
                    this.paddle1Y = canvas.height / 2 - this.paddleHeight / 2;
                    this.paddle2Y = canvas.height / 2 - this.paddleHeight / 2;
                    this.ballX = canvas.width / 2;
                    this.ballY = canvas.height / 2;
                    this.ballSpeedX = 4;
                    this.ballSpeedY = 4;
                    this.score1 = 0;
                    this.score2 = 0;
                    this.paddleSpeed = 6;
                    this.paddle1Direction = 0;
                    this.gameOver = false;
                    this.gameLoop = () => {
                        if (this.gameOver) return;
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        this.movePaddles();
                        this.moveBall();
                        ctx.fillStyle = '#6c43ff';
                        ctx.fillRect(0, this.paddle1Y, this.paddleWidth, this.paddleHeight);
                        ctx.fillRect(canvas.width - this.paddleWidth, this.paddle2Y, this.paddleWidth, this.paddleHeight);
                        ctx.fillStyle = '#ff4757';
                        ctx.beginPath();
                        ctx.arc(this.ballX, this.ballY, this.ballSize / 2, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.strokeStyle = '#6c43ff';
                        ctx.beginPath();
                        ctx.moveTo(canvas.width / 2, 0);
                        ctx.lineTo(canvas.width / 2, canvas.height);
                        ctx.stroke();
                        document.getElementById('pong-score').textContent = `Jugador: ${this.score1} - Bot: ${this.score2}`;
                        requestAnimationFrame(this.gameLoop);
                    };
                    requestAnimationFrame(this.gameLoop);
                    this.keydownHandler = (e) => {
                        if (e.key === 'ArrowUp' || e.key === 'w') this.paddle1Direction = -1;
                        if (e.key === 'ArrowDown' || e.key === 's') this.paddle1Direction = 1;
                    };
                    this.keyupHandler = (e) => {
                        if ((e.key === 'ArrowUp' || e.key === 'w') && this.paddle1Direction === -1) this.paddle1Direction = 0;
                        if ((e.key === 'ArrowDown' || e.key === 's') && this.paddle1Direction === 1) this.paddle1Direction = 0;
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                    window.addEventListener('keyup', this.keyupHandler);
                },
                movePaddles: function() {
                    this.paddle1Y += this.paddle1Direction * this.paddleSpeed;
                    if (this.paddle1Y < 0) this.paddle1Y = 0;
                    if (this.paddle1Y > 400 - this.paddleHeight) this.paddle1Y = 400 - this.paddleHeight;
                    const botTargetY = this.ballY - this.paddleHeight / 2;
                    const botSpeed = 4 * (Math.random() > 0.2 ? 1 : 0.5);
                    if (this.paddle2Y < botTargetY) this.paddle2Y += botSpeed;
                    if (this.paddle2Y > botTargetY) this.paddle2Y -= botSpeed;
                    if (this.paddle2Y < 0) this.paddle2Y = 0;
                    if (this.paddle2Y > 400 - this.paddleHeight) this.paddle2Y = 400 - this.paddleHeight;
                },
                moveBall: function() {
                    this.ballX += this.ballSpeedX;
                    this.ballY += this.ballSpeedY;
                    if (this.ballY - this.ballSize / 2 < 0 || this.ballY + this.ballSize / 2 > 400) {
                        this.ballSpeedY = -this.ballSpeedY;
                        console.log('Sonido: Rebote pared');
                    }
                    if (this.ballX - this.ballSize / 2 < this.paddleWidth && this.ballY > this.paddle1Y && this.ballY < this.paddle1Y + this.paddleHeight) {
                        this.ballSpeedX = Math.abs(this.ballSpeedX);
                        this.ballSpeedY += (this.ballY - (this.paddle1Y + this.paddleHeight / 2)) * 0.1;
                        console.log('Sonido: Rebote paleta');
                    }
                    if (this.ballX + this.ballSize / 2 > 600 - this.paddleWidth && this.ballY > this.paddle2Y && this.ballY < this.paddle2Y + this.paddleHeight) {
                        this.ballSpeedX = -Math.abs(this.ballSpeedX);
                        this.ballSpeedY += (this.ballY - (this.paddle2Y + this.paddleHeight / 2)) * 0.1;
                        console.log('Sonido: Rebote paleta');
                    }
                    if (this.ballX < 0) {
                        this.score2++;
                        this.resetBall();
                        console.log('Sonido: Punto para Bot');
                    } else if (this.ballX > 600) {
                        this.score1++;
                        this.resetBall();
                        console.log('Sonido: Punto para Jugador');
                    }
                    if (this.score1 >= 10) {
                        document.getElementById('pong-score').textContent = `¡Ganaste! Jugador: ${this.score1} - Bot: ${this.score2}`;
                        this.gameOver = true;
                        console.log('Sonido: Victoria');
                    } else if (this.score2 >= 10) {
                        document.getElementById('pong-score').textContent = `¡Perdiste! Jugador: ${this.score1} - Bot: ${this.score2}`;
                        this.gameOver = true;
                        console.log('Sonido: Derrota');
                    }
                },
                resetBall: function() {
                    this.ballX = 300;
                    this.ballY = 200;
                    this.ballSpeedX = this.score1 > this.score2 ? -4 : 4;
                    this.ballSpeedY = (Math.random() - 0.5) * 4;
                }
            },
            'guess-number': {
                title: 'Adivina el Número',
                instructions: 'Adivina el número entre 1 y 100. Ingresa tu número y haz clic en Adivinar o presiona Enter. Te daré pistas.',
                setup: function() {
                    let html = '<div id="guess-number">';
                    html += '<input type="number" id="guess-input" min="1" max="100" value="50">';
                    html += '<button id="guess-btn" class="game-btn">Adivinar</button>';
                    html += '<div id="guess-status" class="game-status">¡Adivina un número entre 1 y 100!</div>';
                    html += '</div>';
                    html += '<button class="game-btn" onclick="games[\'guess-number\'].reset()">Reiniciar</button>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                    document.getElementById('guess-btn').addEventListener('click', () => this.makeGuess());
                    this.keydownHandler = (e) => {
                        if (e.key === 'Enter') this.makeGuess();
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                },
                reset: function() {
                    this.targetNumber = Math.floor(Math.random() * 100) + 1;
                    this.attempts = 0;
                    document.getElementById('guess-status').textContent = '¡Adivina un número entre 1 y 100!';
                    document.getElementById('guess-input').value = '50';
                },
                makeGuess: function() {
                    const guess = parseInt(document.getElementById('guess-input').value);
                    if (isNaN(guess) || guess < 1 || guess > 100) {
                        document.getElementById('guess-status').textContent = 'Por favor, ingresa un número entre 1 y 100.';
                        return;
                    }
                    this.attempts++;
                    if (guess === this.targetNumber) {
                        document.getElementById('guess-status').textContent = `¡Felicidades! Adivinaste el número en ${this.attempts} intentos.`;
                        console.log('Sonido: Victoria');
                    } else if (guess < this.targetNumber) {
                        document.getElementById('guess-status').textContent = 'Demasiado bajo. Intenta de nuevo.';
                        console.log('Sonido: Error');
                    } else {
                        document.getElementById('guess-status').textContent = 'Demasiado alto. Intenta de nuevo.';
                        console.log('Sonido: Error');
                    }
                }
            },
            'minesweeper': {
                title: 'Buscaminas',
                instructions: 'Haz clic en una celda para revelarla. Si es una mina, pierdes. Usa flechas/WASD para mover el cursor y Enter para revelar.',
                setup: function() {
                    let html = '<div id="minesweeper-board"></div>';
                    html += '<div id="minesweeper-status" class="game-status"></div>';
                    html += '<button class="game-btn" onclick="games[\'minesweeper\'].reset()">Reiniciar</button>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                    const cells = document.querySelectorAll('.mine-cell');
                    cells.forEach(cell => cell.addEventListener('click', (e) => {
                        const row = parseInt(e.target.getAttribute('data-row'));
                        const col = parseInt(e.target.getAttribute('data-col'));
                        this.revealCell(row, col);
                    }));
                    this.keydownHandler = (e) => {
                        if (!this.selectedCell) this.selectedCell = { row: 0, col: 0 };
                        const { row, col } = this.selectedCell;
                        if (e.key === 'ArrowUp' || e.key === 'w') {
                            if (row > 0) this.selectedCell.row--;
                        } else if (e.key === 'ArrowDown' || e.key === 's') {
                            if (row < 9) this.selectedCell.row++;
                        } else if (e.key === 'ArrowLeft' || e.key === 'a') {
                            if (col > 0) this.selectedCell.col--;
                        } else if (e.key === 'ArrowRight' || e.key === 'd') {
                            if (col < 16) this.selectedCell.col++;
                        } else if (e.key === 'Enter') {
                            this.revealCell(this.selectedCell.row, this.selectedCell.col);
                        }
                        cells.forEach(c => c.style.border = '');
                        cells[this.getCellIndex(this.selectedCell.row, this.selectedCell.col)].style.border = '2px solid #6c43ff';
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                },
                reset: function() {
                    this.board = Array(10).fill().map(() => Array(17).fill(''));
                    this.revealed = Array(10).fill().map(() => Array(17).fill(false));
                    this.mines = 30;
                    this.gameOver = false;
                    this.placeMines();
                    this.calculateNumbers();
                    this.renderBoard();
                    document.getElementById('minesweeper-status').textContent = '';
                    this.selectedCell = { row: 0, col: 0 };
                    const cells = document.querySelectorAll('.mine-cell');
                    cells.forEach(c => c.style.border = '');
                    cells[0].style.border = '2px solid #6c43ff';
                },
                renderBoard: function() {
                    const board = document.getElementById('minesweeper-board');
                    board.innerHTML = '';
                    for (let i = 0; i < 10; i++) {
                        for (let j = 0; j < 17; j++) {
                            const cell = document.createElement('div');
                            cell.className = 'mine-cell';
                            cell.setAttribute('data-row', i);
                            cell.setAttribute('data-col', j);
                            if (this.revealed[i][j]) {
                                cell.classList.add('revealed');
                                cell.textContent = this.board[i][j] === 'B' ? '💣' : this.board[i][j];
                                if (this.board[i][j] > 0 && this.board[i][j] !== 'B') cell.style.color = '#ffd700';
                                else if (this.board[i][j] === 'B') cell.classList.add('mine');
                            }
                            board.appendChild(cell);
                        }
                    }
                },
                placeMines: function() {
                    let minesPlaced = 0;
                    while (minesPlaced < this.mines) {
                        const row = Math.floor(Math.random() * 10);
                        const col = Math.floor(Math.random() * 17);
                        if (this.board[row][col] !== 'B') {
                            this.board[row][col] = 'B';
                            minesPlaced++;
                        }
                    }
                },
                calculateNumbers: function() {
                    for (let i = 0; i < 10; i++) {
                        for (let j = 0; j < 17; j++) {
                            if (this.board[i][j] !== 'B') {
                                let count = 0;
                                for (let di = -1; di <= 1; di++) {
                                    for (let dj = -1; dj <= 1; dj++) {
                                        const ni = i + di;
                                        const nj = j + dj;
                                        if (ni >= 0 && ni < 10 && nj >= 0 && nj < 17 && this.board[ni][nj] === 'B') {
                                            count++;
                                        }
                                    }
                                }
                                this.board[i][j] = count > 0 ? String(count) : '';
                            }
                        }
                    }
                },
                getCellIndex: function(row, col) {
                    return row * 17 + col;
                },
                revealCell: function(row, col) {
                    if (this.revealed[row][col] || this.gameOver) return;
                    this.revealed[row][col] = true;
                    this.renderBoard();
                    if (this.board[row][col] === 'B') {
                        document.getElementById('minesweeper-status').textContent = '¡Boom! Has perdido.';
                        this.gameOver = true;
                        this.revealAll();
                        console.log('Sonido: Explosión');
                    } else if (this.board[row][col] === '') {
                        this.revealEmpty(row, col);
                        console.log('Sonido: Revelar área');
                    } else {
                        console.log('Sonido: Revelar número');
                    }
                    this.checkWin();
                    this.selectedCell = { row, col };
                },
                revealEmpty: function(row, col) {
                    for (let di = -1; di <= 1; di++) {
                        for (let dj = -1; dj <= 1; dj++) {
                            const ni = row + di;
                            const nj = col + dj;
                            if (ni >= 0 && ni < 10 && nj >= 0 && nj < 17 && !this.revealed[ni][nj]) {
                                this.revealed[ni][nj] = true;
                                if (this.board[ni][nj] === '') {
                                    this.revealEmpty(ni, nj);
                                }
                            }
                        }
                    }
                },
                revealAll: function() {
                    for (let i = 0; i < 10; i++) {
                        for (let j = 0; j < 17; j++) {
                            this.revealed[i][j] = true;
                        }
                    }
                    this.renderBoard();
                },
                checkWin: function() {
                    const totalSafeCells = 10 * 17 - this.mines;
                    const revealedCells = this.revealed.flat().filter(Boolean).length;
                    if (revealedCells === totalSafeCells) {
                        document.getElementById('minesweeper-status').textContent = '¡Has Ganado!';
                        this.gameOver = true;
                        this.revealAll();
                        console.log('Sonido: Victoria');
                    }
                }
            },
            'connect-four': {
                title: 'Cuatro en Línea',
                instructions: 'Haz clic en una columna para soltar tu ficha (roja). El bot juega con amarillo. Gana quien conecte 4 fichas en línea.',
                setup: function() {
                    let html = '<div id="connect-four-board">';
                    for (let i = 0; i < 6; i++) {
                        for (let j = 0; j < 7; j++) {
                            html += `<div class="connect-cell" data-row="${i}" data-col="${j}"></div>`;
                        }
                    }
                    html += '</div>';
                    html += '<div id="connect-status" class="game-status">Turno: Jugador (Rojo)</div>';
                    html += '<button class="game-btn" onclick="games[\'connect-four\'].reset()">Reiniciar</button>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                    const cells = document.querySelectorAll('.connect-cell');
                    cells.forEach(cell => cell.addEventListener('click', (e) => {
                        const col = parseInt(e.target.getAttribute('data-col'));
                        this.dropToken(col);
                    }));
                },
                reset: function() {
                    this.board = Array(6).fill().map(() => Array(7).fill(''));
                    this.currentPlayer = 'red';
                    this.gameOver = false;
                    this.renderBoard();
                    document.getElementById('connect-status').textContent = 'Turno: Jugador (Rojo)';
                },
                renderBoard: function() {
                    for (let i = 0; i < 6; i++) {
                        for (let j = 0; j < 7; j++) {
                            const cell = document.querySelector(`.connect-cell[data-row="${i}"][data-col="${j}"]`);
                            cell.className = 'connect-cell';
                            if (this.board[i][j] === 'red') cell.classList.add('red-token');
                            else if (this.board[i][j] === 'yellow') cell.classList.add('yellow-token');
                        }
                    }
                },
                dropToken: function(col) {
                    if (this.gameOver) return;
                    for (let row = 5; row >= 0; row--) {
                        if (this.board[row][col] === '') {
                            this.board[row][col] = this.currentPlayer;
                            this.renderBoard();
                            console.log(`Sonido: Ficha colocada - ${this.currentPlayer}`);
                            if (this.checkWin(this.currentPlayer)) {
                                document.getElementById('connect-status').textContent = `¡${this.currentPlayer === 'red' ? 'Jugador (Rojo)' : 'Bot (Amarillo)'} ha ganado!`;
                                this.gameOver = true;
                                console.log('Sonido: Victoria');
                                return;
                            }
                            if (this.board.every(row => row.every(cell => cell !== ''))) {
                                document.getElementById('connect-status').textContent = '¡Empate!';
                                this.gameOver = true;
                                console.log('Sonido: Empate');
                                return;
                            }
                            this.currentPlayer = this.currentPlayer === 'red' ? 'yellow' : 'red';
                            document.getElementById('connect-status').textContent = `Turno: ${this.currentPlayer === 'red' ? 'Jugador (Rojo)' : 'Bot (Amarillo)'}`;
                            if (this.currentPlayer === 'yellow') setTimeout(() => this.botTurn(), 500);
                            return;
                        }
                    }
                },
                checkWin: function(player) {
                    for (let row = 0; row < 6; row++) {
                        for (let col = 0; col < 7; col++) {
                            if (this.board[row][col] !== player) continue;
                            if (col <= 3 && [0, 1, 2, 3].every(i => this.board[row][col + i] === player)) return true;
                            if (row <= 2 && [0, 1, 2, 3].every(i => this.board[row + i][col] === player)) return true;
                            if (row <= 2 && col <= 3 && [0, 1, 2, 3].every(i => this.board[row + i][col + i] === player)) return true;
                            if (row >= 3 && col <= 3 && [0, 1, 2, 3].every(i => this.board[row - i][col + i] === player)) return true;
                        }
                    }
                    return false;
                },
                botTurn: function() {
                    if (this.gameOver) return;
                    let col;
                    for (let c = 0; c < 7; c++) {
                        const tempBoard = this.board.map(row => [...row]);
                        for (let r = 5; r >= 0; r--) {
                            if (tempBoard[r][c] === '') {
                                tempBoard[r][c] = 'yellow';
                                if (this.checkWin('yellow')) {
                                    col = c;
                                    break;
                                }
                                tempBoard[r][c] = 'red';
                                if (this.checkWin('red')) {
                                    col = c;
                                    break;
                                }
                                tempBoard[r][c] = '';
                                break;
                            }
                        }
                        if (col !== undefined) break;
                    }
                    col = col !== undefined ? col : Math.floor(Math.random() * 7);
                    this.dropToken(col);
                }
            },
            'memory': {
                title: 'Memoria',
                instructions: 'Haz clic en las cartas para voltearlas y encontrar pares idénticos. Usa flechas o WASD para mover el cursor y Enter para seleccionar. Tienes 60 segundos. Presiona P para pausar.',
                setup: function() {
                    let html = '<div id="memory-game"></div>';
                    html += '<div id="memory-status" class="game-status">Tiempo: 60s - Parejas: 0/8</div>';
                    html += '<div id="memory-controls">';
                    html += '<button class="game-btn" onclick="games[\'memory\'].togglePause()">Pausar</button>';
                    html += '<button class="game-btn" onclick="games[\'memory\'].reset()">Reiniciar</button>';
                    html += '</div>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                    const cards = document.querySelectorAll('.memory-card');
                    cards.forEach(card => card.addEventListener('click', (e) => {
                        if (this.paused || this.flipping) return;
                        const index = parseInt(e.target.getAttribute('data-index'));
                        this.flipCard(index);
                    }));
                    this.keydownHandler = (e) => {
                        e.preventDefault();
                        if (this.paused || this.flipping) return;
                        if (e.key === 'ArrowUp' || e.key === 'w') {
                            if (this.currentIndex > 3) this.currentIndex -= 4;
                        } else if (e.key === 'ArrowDown' || e.key === 's') {
                            if (this.currentIndex < 12) this.currentIndex += 4;
                        } else if (e.key === 'ArrowLeft' || e.key === 'a') {
                            if (this.currentIndex % 4 > 0) this.currentIndex--;
                        } else if (e.key === 'ArrowRight' || e.key === 'd') {
                            if (this.currentIndex % 4 < 3) this.currentIndex++;
                        } else if (e.key === 'Enter') {
                            this.flipCard(this.currentIndex);
                        } else if (e.key === 'p') {
                            this.togglePause();
                        }
                        cards.forEach(c => c.style.border = '');
                        cards[this.currentIndex].style.border = '2px solid #6c43ff';
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                },
                reset: function() {
                    if (this.gameInterval) clearInterval(this.gameInterval);
                    this.cards = [...Array(8).keys(), ...Array(8).keys()];
                    this.cards.sort(() => Math.random() - 0.5);
                    this.flippedCards = [];
                    this.matchedPairs = 0;
                    this.timeLeft = 60;
                    this.gameOver = false;
                    this.paused = false;
                    this.flipping = false;
                    this.currentIndex = 0;
                    const gameBoard = document.getElementById('memory-game');
                    gameBoard.innerHTML = '';
                    for (let i = 0; i < 16; i++) {
                        const card = document.createElement('div');
                        card.className = 'memory-card';
                        card.setAttribute('data-index', i);
                        card.setAttribute('data-value', this.cards[i]);
                        gameBoard.appendChild(card);
                    }
                    document.getElementById('memory-status').textContent = `Tiempo: ${this.timeLeft}s - Parejas: ${this.matchedPairs}/8`;
                    const cards = document.querySelectorAll('.memory-card');
                    cards.forEach(c => c.style.border = '');
                    cards[this.currentIndex].style.border = '2px solid #6c43ff';
                    document.querySelector('#memory-controls button:first-child').textContent = 'Pausar';
                    this.gameInterval = setInterval(() => this.timer(), 1000);
                },
                togglePause: function() {
                    if (this.gameOver) return;
                    this.paused = !this.paused;
                    document.querySelector('#memory-controls button:first-child').textContent = this.paused ? 'Reanudar' : 'Pausar';
                    console.log(`Sonido: ${this.paused ? 'Pausa' : 'Reanudar'}`);
                },
                flipCard: function(index) {
                    if (this.gameOver || this.paused || this.flipping) return;
                    const card = document.querySelectorAll('.memory-card')[index];
                    if (card.classList.contains('flipped') || card.classList.contains('matched')) return;
                    if (this.flippedCards.length >= 2) return;
                    this.flipping = true;
                    card.classList.add('flipped');
                    card.textContent = parseInt(card.getAttribute('data-value')) + 1;
                    this.flippedCards.push({ index, value: card.getAttribute('data-value') });
                    console.log(`Sonido: Carta volteada - ${card.textContent}`);
                    if (this.flippedCards.length === 2) {
                        setTimeout(() => this.checkMatch(), 1000);
                    } else {
                        this.flipping = false;
                    }
                },
                checkMatch: function() {
                    const [card1, card2] = this.flippedCards;
                    const c1 = document.querySelectorAll('.memory-card')[card1.index];
                    const c2 = document.querySelectorAll('.memory-card')[card2.index];
                    if (card1.value === card2.value) {
                        c1.classList.add('matched');
                        c2.classList.add('matched');
                        this.matchedPairs++;
                        console.log('Sonido: Pareja encontrada');
                    } else {
                        c1.classList.remove('flipped');
                        c2.classList.remove('flipped');
                        c1.textContent = '';
                        c2.textContent = '';
                        console.log('Sonido: Error');
                    }
                    this.flippedCards = [];
                    this.flipping = false;
                    document.getElementById('memory-status').textContent = `Tiempo: ${this.timeLeft}s - Parejas: ${this.matchedPairs}/8`;
                    if (this.matchedPairs === 8) {
                        this.gameOver = true;
                        clearInterval(this.gameInterval);
                        document.getElementById('memory-status').textContent = `¡Ganaste! Tiempo restante: ${this.timeLeft}s`;
                        console.log('Sonido: Victoria');
                    }
                },
                timer: function() {
                    if (this.gameOver || this.paused) return;
                    this.timeLeft--;
                    document.getElementById('memory-status').textContent = `Tiempo: ${this.timeLeft}s - Parejas: ${this.matchedPairs}/8`;
                    if (this.timeLeft <= 0) {
                        this.gameOver = true;
                        clearInterval(this.gameInterval);
                        document.getElementById('memory-status').textContent = '¡Tiempo agotado! Has perdido.';
                        document.querySelectorAll('.memory-card').forEach(card => {
                            if (!card.classList.contains('matched')) {
                                card.classList.add('flipped');
                                card.textContent = parseInt(card.getAttribute('data-value')) + 1;
                            }
                        });
                        console.log('Sonido: Derrota');
                    }
                }
            },
            'tetris': {
                title: 'Tetris',
                instructions: 'Usa flechas para mover y rotar las piezas. Flecha abajo para bajar rápido. Llena líneas para sumar puntos. Presiona P para pausar.',
                setup: function() {
                    let html = '<canvas id="tetris-canvas" width="200" height="400"></canvas>';
                    html += '<div id="tetris-score" class="game-status">Puntuación: 0</div>';
                    html += '<div id="tetris-controls">';
                    html += '<button class="game-btn" onclick="games[\'tetris\'].togglePause()">Pausar</button>';
                    html += '<button class="game-btn" onclick="games[\'tetris\'].reset()">Reiniciar</button>';
                    html += '</div>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                },
                reset: function() {
                    if (this.gameLoop) cancelAnimationFrame(this.gameLoop);
                    const canvas = document.getElementById('tetris-canvas');
                    this.ctx = canvas.getContext('2d');
                    this.board = Array(20).fill().map(() => Array(10).fill(0));
                    this.score = 0;
                    this.gameOver = false;
                    this.paused = false;
                    this.piece = this.newPiece();
                    this.dropCounter = 0;
                    this.dropInterval = 1000; // 1 segundo por caída
                    this.lastTime = 0;
                    document.getElementById('tetris-score').textContent = `Puntuación: ${this.score}`;
                    document.querySelector('#tetris-controls button:first-child').textContent = 'Pausar';
                    this.gameLoop = (time = 0) => {
                        if (this.gameOver || this.paused) return;
                        const deltaTime = time - this.lastTime;
                        this.lastTime = time;
                        this.dropCounter += deltaTime;
                        if (this.dropCounter > this.dropInterval) {
                            this.moveDown();
                            this.dropCounter = 0;
                        }
                        this.ctx.clearRect(0, 0, canvas.width, canvas.height);
                        this.drawBoard();
                        this.drawPiece();
                        this.gameLoopId = requestAnimationFrame(this.gameLoop);
                    };
                    requestAnimationFrame(this.gameLoop);
                    this.keydownHandler = (e) => {
                        e.preventDefault();
                        if (this.gameOver || this.paused) return;
                        if (e.key === 'ArrowLeft' || e.key === 'a') this.moveLeft();
                        if (e.key === 'ArrowRight' || e.key === 'd') this.moveRight();
                        if (e.key === 'ArrowDown' || e.key === 's') this.moveDown();
                        if (e.key === 'ArrowUp' || e.key === 'w') this.rotate();
                        if (e.key === 'p') this.togglePause();
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                },
                togglePause: function() {
                    if (this.gameOver) return;
                    this.paused = !this.paused;
                    document.querySelector('#tetris-controls button:first-child').textContent = this.paused ? 'Reanudar' : 'Pausar';
                    console.log(`Sonido: ${this.paused ? 'Pausa' : 'Reanudar'}`);
                    if (!this.paused) requestAnimationFrame(this.gameLoop);
                },
                newPiece: function() {
                    const shapes = [
                        [[1, 1, 1, 1]], // I
                        [[1, 1], [1, 1]], // O
                        [[1, 1, 1], [0, 1, 0]], // T
                        [[1, 1, 1], [1, 0, 0]], // L
                        [[1, 1, 1], [0, 0, 1]] // J
                    ];
                    return {
                        shape: shapes[Math.floor(Math.random() * shapes.length)],
                        x: 4,
                        y: 0,
                        color: '#' + Math.floor(Math.random() * 16777215).toString(16)
                    };
                },
                drawBoard: function() {
                    this.ctx.fillStyle = '#1e2133';
                    this.ctx.fillRect(0, 0, 200, 400);
                    for (let i = 0; i < 20; i++) {
                        for (let j = 0; j < 10; j++) {
                            if (this.board[i][j]) {
                                this.ctx.fillStyle = this.board[i][j];
                                this.ctx.fillRect(j * 20, i * 20, 19, 19);
                            }
                        }
                    }
                },
                drawPiece: function() {
                    this.ctx.fillStyle = this.piece.color;
                    for (let i = 0; i < this.piece.shape.length; i++) {
                        for (let j = 0; j < this.piece.shape[i].length; j++) {
                            if (this.piece.shape[i][j]) {
                                this.ctx.fillRect((this.piece.x + j) * 20, (this.piece.y + i) * 20, 19, 19);
                            }
                        }
                    }
                },
                moveLeft: function() {
                    this.piece.x--;
                    if (this.collides()) this.piece.x++;
                },
                moveRight: function() {
                    this.piece.x++;
                    if (this.collides()) this.piece.x--;
                },
                moveDown: function() {
                    this.piece.y++;
                    if (this.collides()) {
                        this.piece.y--;
                        this.merge();
                        this.clearLines();
                        this.piece = this.newPiece();
                        if (this.collides()) {
                            this.gameOver = true;
                            cancelAnimationFrame(this.gameLoopId);
                            document.getElementById('tetris-score').textContent = `Game Over! Puntuación: ${this.score}`;
                            console.log('Sonido: Derrota');
                        }
                    }
                },
                rotate: function() {
                    const rotated = Array(this.piece.shape[0].length).fill().map(() => Array(this.piece.shape.length).fill(0));
                    for (let i = 0; i < this.piece.shape.length; i++) {
                        for (let j = 0; j < this.piece.shape[i].length; j++) {
                            rotated[j][this.piece.shape.length - 1 - i] = this.piece.shape[i][j];
                        }
                    }
                    const originalShape = this.piece.shape;
                    this.piece.shape = rotated;
                    if (this.collides()) {
                        this.piece.shape = originalShape;
                        this.adjustPiece();
                    }
                },
                adjustPiece: function() {
                    while (this.collides()) {
                        if (this.piece.x < 5) this.piece.x++;
                        else this.piece.x--;
                        if (!this.collides()) break;
                        this.piece.x = 4;
                        this.piece.y--;
                        if (this.piece.y < 0) {
                            this.gameOver = true;
                            break;
                        }
                    }
                },
                collides: function() {
                    for (let i = 0; i < this.piece.shape.length; i++) {
                        for (let j = 0; j < this.piece.shape[i].length; j++) {
                            if (this.piece.shape[i][j]) {
                                const newX = this.piece.x + j;
                                const newY = this.piece.y + i;
                                if (newX < 0 || newX >= 10 || newY >= 20 || (newY >= 0 && this.board[newY][newX])) return true;
                            }
                        }
                    }
                    return false;
                },
                merge: function() {
                    for (let i = 0; i < this.piece.shape.length; i++) {
                        for (let j = 0; j < this.piece.shape[i].length; j++) {
                            if (this.piece.shape[i][j]) {
                                const newY = this.piece.y + i;
                                if (newY >= 0) this.board[newY][this.piece.x + j] = this.piece.color;
                            }
                        }
                    }
                },
                clearLines: function() {
                    for (let i = 19; i >= 0; i--) {
                        if (this.board[i].every(cell => cell)) {
                            this.board.splice(i, 1);
                            this.board.unshift(Array(10).fill(0));
                            this.score += 100;
                            console.log('Sonido: Línea eliminada');
                            document.getElementById('tetris-score').textContent = `Puntuación: ${this.score}`;
                            i++;
                        }
                    }
                }
            },
            'pacman': {
                title: 'Pacman',
                instructions: 'Usa flechas o WASD para mover a Pacman. Come todos los puntos para ganar. Evita a los fantasmas. Presiona P para pausar.',
                setup: function() {
                    let html = '<canvas id="pacman-canvas" width="400" height="400"></canvas>';
                    html += '<div id="pacman-score" class="game-status">Puntuación: 0 - Nivel: 1</div>';
                    html += '<div id="pacman-controls">';
                    html += '<button class="game-btn" onclick="games[\'pacman\'].togglePause()">Pausar</button>';
                    html += '<button class="game-btn" onclick="games[\'pacman\'].reset()">Reiniciar</button>';
                    html += '</div>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                },
                reset: function() {
                    if (this.gameLoop) cancelAnimationFrame(this.gameLoop);
                    const canvas = document.getElementById('pacman-canvas');
                    this.ctx = canvas.getContext('2d');
                    this.cellSize = 20;
                    this.board = Array(20).fill().map(() => Array(20).fill('.'));
                    for (let i = 0; i < 20; i++) {
                        this.board[0][i] = '#';
                        this.board[19][i] = '#';
                        this.board[i][0] = '#';
                        this.board[i][19] = '#';
                    }
                    this.pacman = { x: 1, y: 1 };
                    this.dots = 0;
                    for (let i = 1; i < 19; i++) {
                        for (let j = 1; j < 19; j++) {
                            if (this.board[i][j] === '.') this.dots++;
                        }
                    }
                    this.ghosts = [
                        { x: 18, y: 18, color: '#ff4757' },
                        { x: 18, y: 1, color: '#00ff00' }
                    ];
                    this.score = 0;
                    this.level = 1;
                    this.gameOver = false;
                    this.paused = false;
                    this.direction = 'right';
                    this.nextDirection = 'right';
                    this.ghostSpeed = 0.5;
                    this.gameLoop = () => {
                        if (this.gameOver || this.paused) return;
                        this.ctx.clearRect(0, 0, canvas.width, canvas.height);
                        this.movePacman();
                        this.moveGhosts();
                        this.drawBoard();
                        this.drawEntities();
                        document.getElementById('pacman-score').textContent = `Puntuación: ${this.score} - Nivel: ${this.level}`;
                        requestAnimationFrame(this.gameLoop);
                    };
                    requestAnimationFrame(this.gameLoop);
                    this.keydownHandler = (e) => {
                        e.preventDefault();
                        if (e.key === 'ArrowUp' || e.key === 'w') this.nextDirection = 'up';
                        if (e.key === 'ArrowDown' || e.key === 's') this.nextDirection = 'down';
                        if (e.key === 'ArrowLeft' || e.key === 'a') this.nextDirection = 'left';
                        if (e.key === 'ArrowRight' || e.key === 'd') this.nextDirection = 'right';
                        if (e.key === 'p') this.togglePause();
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                    document.querySelector('#pacman-controls button:first-child').textContent = 'Pausar';
                },
                togglePause: function() {
                    if (this.gameOver) return;
                    this.paused = !this.paused;
                    document.querySelector('#pacman-controls button:first-child').textContent = this.paused ? 'Reanudar' : 'Pausar';
                    console.log(`Sonido: ${this.paused ? 'Pausa' : 'Reanudar'}`);
                    if (!this.paused) requestAnimationFrame(this.gameLoop);
                },
                drawBoard: function() {
                    this.ctx.fillStyle = '#1e2133';
                    this.ctx.fillRect(0, 0, 400, 400);
                    for (let i = 0; i < 20; i++) {
                        for (let j = 0; j < 20; j++) {
                            if (this.board[i][j] === '#') {
                                this.ctx.fillStyle = '#6c43ff';
                                this.ctx.fillRect(j * this.cellSize, i * this.cellSize, this.cellSize, this.cellSize);
                            } else if (this.board[i][j] === '.') {
                                this.ctx.fillStyle = '#ff4757';
                                this.ctx.fillRect(j * this.cellSize + 8, i * this.cellSize + 8, 4, 4);
                            }
                        }
                    }
                },
                drawEntities: function() {
                    this.ctx.fillStyle = '#ffd700';
                    this.ctx.beginPath();
                    const angle = this.direction === 'right' ? [0.25, 1.75] : this.direction === 'left' ? [1.25, 2.75] : this.direction === 'up' ? [1.75, 0.75] : [0.75, 1.25];
                    this.ctx.arc(this.pacman.x * this.cellSize + this.cellSize / 2, this.pacman.y * this.cellSize + this.cellSize / 2, this.cellSize / 2 - 2, angle[0] * Math.PI, angle[1] * Math.PI);
                    this.ctx.lineTo(this.pacman.x * this.cellSize + this.cellSize / 2, this.pacman.y * this.cellSize + this.cellSize / 2);
                    this.ctx.fill();
                    this.ghosts.forEach(ghost => {
                        this.ctx.fillStyle = ghost.color;
                        this.ctx.beginPath();
                        this.ctx.arc(ghost.x * this.cellSize + this.cellSize / 2, ghost.y * this.cellSize + this.cellSize / 2, this.cellSize / 2 - 2, 0, Math.PI * 2);
                        this.ctx.fill();
                    });
                },
                movePacman: function() {
                    if (this.direction === this.nextDirection || ['right', 'left'].includes(this.direction) && ['right', 'left'].includes(this.nextDirection) || ['up', 'down'].includes(this.direction) && ['up', 'down'].includes(this.nextDirection)) {
                        this.direction = this.nextDirection;
                    }
                    let newX = this.pacman.x;
                    let newY = this.pacman.y;
                    switch (this.direction) {
                        case 'up': newY--; break;
                        case 'down': newY++; break;
                        case 'left': newX--; break;
                        case 'right': newX++; break;
                    }
                    if (this.board[newY][newX] !== '#') {
                        if (this.board[newY][newX] === '.') {
                            this.board[newY][newX] = '';
                            this.score += 10;
                            this.dots--;
                            console.log('Sonido: Punto comido');
                        }
                        this.pacman.x = newX;
                        this.pacman.y = newY;
                        if (this.dots === 0) {
                            this.level++;
                            this.ghostSpeed += 0.1;
                            this.resetLevel();
                            console.log('Sonido: Nivel completado');
                        }
                        if (this.ghosts.some(ghost => Math.abs(ghost.x - this.pacman.x) < 0.5 && Math.abs(ghost.y - this.pacman.y) < 0.5)) {
                            this.gameOver = true;
                            document.getElementById('pacman-score').textContent = `Game Over! Puntuación: ${this.score} - Nivel: ${this.level}`;
                            console.log('Sonido: Derrota');
                        }
                    }
                },
                moveGhosts: function() {
                    this.ghosts.forEach(ghost => {
                        const directions = [];
                        if (this.board[Math.floor(ghost.y) - 1][Math.floor(ghost.x)] !== '#') directions.push('up');
                        if (this.board[Math.floor(ghost.y) + 1][Math.floor(ghost.x)] !== '#') directions.push('down');
                        if (this.board[Math.floor(ghost.y)][Math.floor(ghost.x) - 1] !== '#') directions.push('left');
                        if (this.board[Math.floor(ghost.y)][Math.floor(ghost.x) + 1] !== '#') directions.push('right');
                        const dir = directions[Math.floor(Math.random() * directions.length)];
                        switch (dir) {
                            case 'up': ghost.y -= this.ghostSpeed; break;
                            case 'down': ghost.y += this.ghostSpeed; break;
                            case 'left': ghost.x -= this.ghostSpeed; break;
                            case 'right': ghost.x += this.ghostSpeed; break;
                        }
                        if (ghost.x < 1) ghost.x = 1;
                        if (ghost.x > 18) ghost.x = 18;
                        if (ghost.y < 1) ghost.y = 1;
                        if (ghost.y > 18) ghost.y = 18;
                    });
                },
                resetLevel: function() {
                    this.board = Array(20).fill().map(() => Array(20).fill('.'));
                    for (let i = 0; i < 20; i++) {
                        this.board[0][i] = '#';
                        this.board[19][i] = '#';
                        this.board[i][0] = '#';
                        this.board[i][19] = '#';
                    }
                    this.pacman = { x: 1, y: 1 };
                    this.dots = 0;
                    for (let i = 1; i < 19; i++) {
                        for (let j = 1; j < 19; j++) {
                            if (this.board[i][j] === '.') this.dots++;
                        }
                    }
                    this.ghosts = [
                        { x: 18, y: 18, color: '#ff4757' },
                        { x: 18, y: 1, color: '#00ff00' }
                    ];
                    this.direction = 'right';
                    this.nextDirection = 'right';
                }
            },
            'breakout': {
                title: 'Breakout',
                instructions: 'Usa flechas izquierda/derecha o A/D para mover la paleta. También puedes usar el ratón. Destruye todos los ladrillos para ganar. Presiona P para pausar.',
                setup: function() {
                    let html = '<canvas id="breakout-canvas" width="600" height="400"></canvas>';
                    html += '<div id="breakout-score" class="game-status">Puntuación: 0 - Vidas: 3</div>';
                    html += '<div id="breakout-controls">';
                    html += '<button class="game-btn" onclick="games[\'breakout\'].togglePause()">Pausar</button>';
                    html += '<button class="game-btn" onclick="games[\'breakout\'].reset()">Reiniciar</button>';
                    html += '</div>';
                    document.getElementById('game-content').innerHTML = html;
                    this.reset();
                },
                reset: function() {
                    if (this.gameLoop) cancelAnimationFrame(this.gameLoop);
                    const canvas = document.getElementById('breakout-canvas');
                    this.ctx = canvas.getContext('2d');
                    this.paddle = { x: 250, y: 360, width: 100, height: 10 };
                    this.ball = { x: 300, y: 350, dx: 4, dy: -4, radius: 10 };
                    this.bricks = [];
                    this.score = 0;
                    this.lives = 3;
                    this.gameOver = false;
                    this.paused = false;
                    this.createWall();
                    this.gameLoop = () => {
                        if (this.gameOver || this.paused) return;
                        this.ctx.clearRect(0, 0, canvas.width, canvas.height);
                        this.moveBall();
                        this.drawPaddle();
                        this.drawBall();
                        this.drawBricks();
                        this.ctx.fillStyle = '#6c43ff';
                        this.ctx.font = '20px Arial';
                        this.ctx.fillText(`Vidas: ${this.lives}`, 10, 30);
                        document.getElementById('breakout-score').textContent = `Puntuación: ${this.score} - Vidas: ${this.lives}`;
                        requestAnimationFrame(this.gameLoop);
                    };
                    requestAnimationFrame(this.gameLoop);
                    this.keydownHandler = (e) => {
                        e.preventDefault();
                        if (e.key === 'ArrowLeft' || e.key === 'a') this.paddle.x = Math.max(0, this.paddle.x - 20);
                        if (e.key === 'ArrowRight' || e.key === 'd') this.paddle.x = Math.min(500, this.paddle.x + 20);
                        if (e.key === 'p') this.togglePause();
                    };
                    window.addEventListener('keydown', this.keydownHandler);
                    this.mouseMoveHandler = (e) => {
                        const rect = canvas.getBoundingClientRect();
                        this.paddle.x = e.clientX - rect.left - this.paddle.width / 2;
                        if (this.paddle.x < 0) this.paddle.x = 0;
                        if (this.paddle.x > canvas.width - this.paddle.width) this.paddle.x = canvas.width - this.paddle.width;
                    };
                    canvas.addEventListener('mousemove', this.mouseMoveHandler);
                    document.querySelector('#breakout-controls button:first-child').textContent = 'Pausar';
                },
                togglePause: function() {
                    if (this.gameOver) return;
                    this.paused = !this.paused;
                    document.querySelector('#breakout-controls button:first-child').textContent = this.paused ? 'Reanudar' : 'Pausar';
                    console.log(`Sonido: ${this.paused ? 'Pausa' : 'Reanudar'}`);
                    if (!this.paused) requestAnimationFrame(this.gameLoop);
                },
                createWall: function() {
                    this.bricks = [];
                    for (let i = 0; i < 4; i++) {
                        for (let j = 0; j < 10; j++) {
                            this.bricks.push({ x: j * 60, y: i * 30 + 50, width: 58, height: 28, hit: false });
                        }
                    }
                },
                drawPaddle: function() {
                    this.ctx.fillStyle = '#6c43ff';
                    this.ctx.fillRect(this.paddle.x, this.paddle.y, this.paddle.width, this.paddle.height);
                },
                drawBall: function() {
                    this.ctx.fillStyle = '#ff4757';
                    this.ctx.beginPath();
                    this.ctx.arc(this.ball.x, this.ball.y, this.ball.radius, 0, Math.PI * 2);
                    this.ctx.fill();
                },
                drawBricks: function() {
                    this.ctx.fillStyle = '#2ed573';
                    this.bricks.forEach(brick => {
                        if (!brick.hit) {
                            this.ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
                        }
                    });
                },
                moveBall: function() {
                    this.ball.x += this.ball.dx;
                    this.ball.y += this.ball.dy;
                    if (this.ball.y - this.ball.radius < 0) {
                        this.ball.dy = -this.ball.dy;
                        console.log('Sonido: Rebote techo');
                    }
                    if (this.ball.x + this.ball.radius > 600 || this.ball.x - this.ball.radius < 0) {
                        this.ball.dx = -this.ball.dx;
                        console.log('Sonido: Rebote pared');
                    }
                    if (this.ball.y + this.ball.radius > this.paddle.y && this.ball.y - this.ball.radius < this.paddle.y + this.paddle.height &&
                        this.ball.x > this.paddle.x && this.ball.x < this.paddle.x + this.paddle.width) {
                        this.ball.dy = -Math.abs(this.ball.dy);
                        this.ball.dx += (this.ball.x - (this.paddle.x + this.paddle.width / 2)) * 0.1;
                        console.log('Sonido: Rebote paleta');
                    }
                    if (this.ball.y + this.ball.radius > 400) {
                        this.lives--;
                        if (this.lives > 0) {
                            this.ball.x = 300;
                            this.ball.y = 350;
                            this.ball.dx = 4;
                            this.ball.dy = -4;
                            this.paddle.x = 250;
                            console.log('Sonido: Vida perdida');
                        } else {
                            this.gameOver = true;
                            document.getElementById('breakout-score').textContent = `Game Over! Puntuación: ${this.score} - Vidas: 0`;
                            console.log('Sonido: Derrota');
                        }
                    }
                    this.bricks.forEach(brick => {
                        if (!brick.hit && this.ball.x + this.ball.radius > brick.x && this.ball.x - this.ball.radius < brick.x + brick.width &&
                            this.ball.y + this.ball.radius > brick.y && this.ball.y - this.ball.radius < brick.y + brick.height) {
                            this.ball.dy = -this.ball.dy;
                            brick.hit = true;
                            this.score += 50;
                            console.log('Sonido: Ladrillo destruido');
                        }
                    });
                    if (this.bricks.every(brick => brick.hit)) {
                        this.gameOver = true;
                        document.getElementById('breakout-score').textContent = `¡Ganaste! Puntuación: ${this.score} - Vidas: ${this.lives}`;
                        console.log('Sonido: Victoria');
                    }
                }
            }
        };
    </script>
</body>
</html>